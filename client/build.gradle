dependencies {
	compile project(':contract')

	compile(group: 'io.swagger', name: 'swagger-codegen-cli', version: '2.2.0') {
		exclude(module: 'org.slf4j')
		exclude(module: 'log4j')
		exclude(module: 'logback-classic')
	}
	compile group: 'com.squareup.okhttp', name: 'okhttp', version: '2.7.5'
	compile group: 'com.squareup.okhttp', name: 'logging-interceptor', version: '2.7.5'
	compile group: 'com.google.code.gson', name: 'gson', version: '2.7'
}

wsdl2java {
	encoding = 'utf-8'
	wsdlsToGenerate = [
			[
					'-wsdlLocation', 'classpath:v1/wsdl/series.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/series.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/performer.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/performer.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/staff.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/staff.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/character.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/character.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/episode.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/episode.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/movie.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/movie.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/astronomicalObject.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/astronomicalObject.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/company.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/company.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/comicSeries.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/comicSeries.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/comics.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/comics.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/comicStrip.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/comicStrip.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/comicCollection.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/comicCollection.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/species.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/species.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/organization.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/organization.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/food.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/food.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/location.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/location.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/bookSeries.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/bookSeries.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/book.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/book.wsdl"
			],
			[
					'-wsdlLocation', 'classpath:v1/wsdl/bookCollection.wsdl',
					'-p','com.cezarykluczynski.stapi.client.v1.soap',
					'-autoNameResolution', "./contract/src/main/resources/v1/wsdl/bookCollection.wsdl"
			]
	]
	generatedWsdlDir = file("$projectDir/build/generated/src/main/java")
	wsdlDir = file("$projectDir/src/main/resources")
}

sourceSets {
	main {
		resources {
			srcDirs = ['../contract/src/main/resources/']
		}
	}
}

task swaggerGenerate(type: Exec) {
	File file = project.configurations.compile.find {
		it.name.startsWith("swagger-codegen-cli-")
	}

	println 'Using swagger-codegen-cli: ' << file.absolutePath

	workingDir "../"

	commandLine "java", "-jar", "${file.absolutePath}", "generate",
			"-l", "java",
			"-i", "contract/src/main/resources/v1/swagger/stapi.yaml",
			"-c", "contract/src/main/resources/v1/swagger/config.json",
			"-o", "./client/build/generated"
}

compileJava {
	dependsOn(wsdl2java, swaggerGenerate)
	source += "build/generated/src/main/java/"
}
